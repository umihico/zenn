---
title: "Slackã®Github Botã§è‡ªå‹•ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆã‚’ä½œã£ãŸè©±"
emoji: "ğŸ‰"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["github", "slack", "githubactions"]
published: false
---

zennåˆè¨˜äº‹ã§ã™ã€‚ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ã€‚

ã“ã‚“ãªæ„Ÿã˜ã§ã€æœ¬ç•ªåæ˜ ãŒå®Œäº†ã—ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«Slackãƒãƒ£ãƒ³ãƒãƒ«ã«å¤‰æ›´å†…å®¹ã‚’æŠ•ä¸‹ã—ã¦ã„ã¾ã™ã€‚

![](/images/articles/d3dab37f9432f7.md/example.png)

## ãƒªãƒªãƒ¼ã‚¹ã”ã¨ã«å ±é€£ç›¸ã¯ãƒ„ãƒ©ã‚¤ã‚ˆ

çš†ã•ã‚“ã¯äº‹æ¥­éƒ¨ã«æ©Ÿèƒ½ã®è¿½åŠ ã€æ›´æ–°ã€å‰Šé™¤ã‚„ãƒã‚°ä¿®æ­£ãªã©ã®é€£çµ¡ã‚’ã©ã®ã‚ˆã†ã«è¡Œã£ã¦ã„ã‚‹ã§ã—ã‚‡ã†ã‹ã€‚
é–‹ç™ºã‚µã‚¤ã‚¯ãƒ«ã€ãƒ‡ãƒ—ãƒ­ã‚¤é »åº¦ã‚’é«˜ã‚ã¦ç”Ÿç”£æ€§ã‚’é«˜ã‚ã‚‹ã¨ã„ã†ã®ãŒæ˜¨ä»Šã®ãƒˆãƒ¬ãƒ³ãƒ‰ã§ã™ãŒã€ãã®åº¦ã«ãƒ“ã‚¸ãƒã‚¹ã‚µã‚¤ãƒ‰ã«ã¡ã‚ƒã‚“ã¨é€£çµ¡ã‚’è¡Œã£ã¦ã„ã‚‹ã§ã—ã‚‡ã†ã‹ã€‚

å®Ÿéš›ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãŸã³ã«é€£çµ¡ã™ã‚‹ã®ã¯ã€ãã‚Œã“ãéæ©Ÿèƒ½è¦ä»¶ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãªã©ã€ãƒ“ã‚¸ãƒã‚¹ã‚µã‚¤ãƒ‰ãŒèªçŸ¥ã§ããªã„ã‚‚ã®ã‚‚å¤šã€…ã‚ã‚Šã€ã‚ã–ã‚ã–é€£çµ¡ã—ãŸããªã„é›°å›²æ°—ãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚
çµå±€ç§ã®çµŒé¨“ã ã¨ã€æœ¬ç•ªã¸ã®åæ˜ ã¯ãƒªã‚¹ã‚¯ãŒã‚ã‚‹è¡Œç‚ºã§ã‚ã‚ŠãªãŒã‚‰ã‚‚ã€ã‚ã¼ã—ã„ã‚‚ã®ã®ã¨ãã ã‘ç°¡æ˜“ãªãƒ†ã‚­ã‚¹ãƒˆã§é€ã‚‹ã€ã¨ã„ã†ç€åœ°ã«ãªã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚

ã—ã‹ã—ã“ã®çŠ¶æ…‹ã¯å±äººçš„ã«é‹ç”¨ã•ã‚Œã‚‹ãŸã‚ã€ä»¥ä¸‹ã®ãƒ‡ãƒ¡ãƒªãƒƒãƒˆãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã€‚

- è»½å¾®ãªå¤‰æ›´ã€ã¾ãŸã¯ãƒã‚°ä¿®æ­£ã§ã‚ã£ã¦ã‚‚ã€ãƒ“ã‚¸ãƒã‚¹ã‚µã‚¤ãƒ‰ãŒã»ã—ã„é€£çµ¡ãŒã•ã‚Œãªã„å¯èƒ½æ€§ãŒã‚ã‚‹
- é€£çµ¡ã™ã‚‹å ´åˆã§ã‚‚ã€æœ¬ç•ªåæ˜ ã‹ã‚‰æ‰‹å‹•é€ä¿¡ã§ã¯æ•°åˆ†ã‹ã‚‰æ•°æ™‚é–“ã®ã‚¿ã‚¤ãƒ ãƒ©ã‚°ãŒç”Ÿã˜ã‚‹
- éæ©Ÿèƒ½è¦ä»¶ã«å–ã‚Šçµ„ã‚€ãƒ¡ãƒ³ãƒãƒ¼ã®æ´»èºãŒãƒ“ã‚¸ãƒã‚¹ã‚µã‚¤ãƒ‰ã‹ã‚‰è¦‹ãˆã«ãã„

ã¨ã¯ã„ãˆã€å³ã—ããƒ«ãƒ¼ãƒ«ä½œã‚Šã—ã¦è§£æ¶ˆã™ã‚‹ãªã‚‰ã€ãã®è² è·ã¯ãã‚Œãªã‚Šã®ã‚‚ã®ã§ã™ã€‚é–‹ç™ºã‚µã‚¤ã‚¯ãƒ«ã®æ—©ã„è‰¯å¥½ãªãƒãƒ¼ãƒ ã»ã©è² æ‹…ã¯å¤§ãããªã‚Šã¾ã™ã€‚
ä»Šå›ã¯æ‰‹é–“ã‹ã‘ãšã“ã®çŠ¶æ…‹ã‚’è§£æ¶ˆã™ã‚‹ãŸã‚ã¨ã€åŠ ãˆã¦ä»¥ä¸‹ã®ç›®çš„ã§ã€ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆã®è‡ªå‹•åŒ–ã‚’è©¦ã¿ã¾ã—ãŸ

- ã€Œèª°ãŒã€ã€Œã©ã®ãƒªãƒªãƒ¼ã‚¹ã€ã«è²¢çŒ®ã—ãŸã‹å°ã•ã„ã‚‚ã®ã§ã‚‚è¦‹ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹
- å–ã‚Šçµ„ã‚“ã æ–½ç­–ã®æ•°ã€ãƒã‚°ä¿®æ­£ã®æ•°ã‚’å°ã•ã„ã‚‚ã®ã‚‚å«ã‚ã€å¾Œã«æŒ¯ã‚Šè¿”ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹
- ãƒ“ã‚¸ãƒã‚¹ã‚µã‚¤ãƒ‰ï¼ˆéã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ï¼‰ãŒæŠ±ãã€Œã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒã¡ã‚ƒã‚“ã¨ä»•äº‹ã—ã¦ã‚‹ã®ã‹åˆ†ã‹ã‚‰ã‚“ã€å•é¡Œã®è»½æ¸›
- ãƒ—ãƒ«ãƒªã‚¯ã®ã‚¿ã‚¤ãƒˆãƒ«ãŒé›‘ã«ãªã‚ŠãŒã¡


## æŠ€è¡“é¸å®šã§Github Botã‚’é¸ã‚“ã çµŒç·¯

ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆè‡ªä½“ã®æ©Ÿèƒ½é–‹ç™ºã§ã¯ãªã„ãŸã‚ã€æ™‚é–“ã‚’ã‹ã‘ãšå®Ÿè£…ã—ãŸã‹ã£ãŸã‹ã‚‰ã§ã™ã€‚æ™‚çŸ­ã™ã‚‹ãŸã‚ã«ä»¥ä¸‹ã®ã“ã¨ã‚’è€ƒãˆã¾ã—ãŸ

- mainãƒ–ãƒ©ãƒ³ãƒã®ãƒ—ãƒ«ãƒªã‚¯ã®è‡ªå‹•ç”Ÿæˆãƒ†ã‚­ã‚¹ãƒˆã‚’ãã®ã¾ã¾ä½¿ã„ãŸã„ï¼ˆ[git-pr-release](https://github.com/x-motemen/git-pr-release)ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚ï¼‰
- ãƒ—ãƒ«ãƒªã‚¯æ–‡ä¸­ã®Githubãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã‚’ã€Slackãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã«å¤‰æ›ã—ãŸã„

æ™‚çŸ­ã®ãŸã‚ãƒ—ãƒ«ãƒªã‚¯ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ãã®ã¾ã¾å¼•ç”¨ã™ã‚‹ã®ã¯è‰¯ã„ã¨ã—ã¦ã€ãã†ãªã‚‹ã¨ãƒ—ãƒ«ãƒªã‚¯ã®ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ãŒSlackã«å¤‰æ›ã§ããªã„ã¨ã€Slackã«ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆã‚’æŠ•ä¸‹ã—ã¦ã‚‚ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ä»¥å¤–ã¯èª°ã®ã“ã¨ã‹ã•ã£ã±ã‚Šåˆ†ã‹ã‚Šã¾ã›ã‚“ã€‚

ã“ã“ã‚’è§£æ±ºã§ããªã„ã‹è€ƒãˆã¦ã„ãŸã®ã§ã™ãŒã€[Github Bot](https://slack.github.com/)ã§ã®`/github subscribe`ã§ãã‚‹é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯æ—¢ã«ã“ã®å•é¡Œã‚’è§£æ±ºã—ã¦ã„ã¾ã™ã€‚ã“ã®botãŒæŠ•ä¸‹ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯å…¨ã¦ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³å¤‰æ›æ¸ˆã¿ã§ã™ã€‚ã‚ˆã£ã¦ã€ã“ã®Botã‚’ãªã‚“ã¨ã‹æµç”¨ã§ããªã„ã‹ã¨è€ƒãˆãŸã‚ã‘ã§ã™ã€‚ã€€

ï¼ˆâ€»ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³å¤‰æ›ã¯é–‹ç™ºè€…å„äººãŒ`/github signin`ã‚’å®Ÿè¡Œã—ã¦é€£æºã‚’å®Œäº†ã—ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚[å‚è€ƒ](https://enokawa.hatenablog.jp/entry/2022/06/01/144341)ï¼‰

ã“ã“ã§ã¡ã‚‡ã£ã¨ã—ãŸãƒãƒƒã‚¯ã§ã™ãŒã€Slackã«æŠ•ä¸‹ã—ã¦ã»ã—ã„ã®ã¯ã€ãƒãƒ¼ã‚¸å¾Œã«CIãŒèµ°ã‚Šæœ¬ç•ªåæ˜ ã—ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã‚ã‚Šã€ãƒ—ãƒ«ãƒªã‚¯ã®open,closeã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãã“ã§Botã®subscribeæ¡ä»¶å¼ã«ãƒ©ãƒ™ãƒ«ãŒä½¿ãˆã‚‹ã“ã¨ã«ç€ç›®ã—ã¦ã€æœ¬ç•ªåæ˜ ã—ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ghã‚³ãƒãƒ³ãƒ‰ã§ãƒ©ãƒ™ãƒ«ä»˜ä¸ã¨ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¡Œã„ã¾ã—ãŸã€‚ãã†ã™ã‚‹ã“ã¨ã§æŠ•ç¨¿ã•ã‚Œã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’åˆ¶å¾¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### æ‰‹é †ï¼‘/2ã€Slackãƒãƒ£ãƒ³ãƒãƒ«ã‚’æ•´ãˆã‚‹

ãƒ—ãƒ«ãƒªã‚¯ã®ã‚³ãƒ¡ãƒ³ãƒˆã¯æœ¬ä½“ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã«ã¤ãã‚ˆã†ã«ã—ã¾ã™ã€‚ï¼ˆç¾åœ¨ã¯ãƒ‡ãƒ•ã‚©ã§ãã†ãªã£ã¦ã‚‹ã‚ˆã†ã§ã™ãŒä¸€å¿œï¼‰

`/github settings`ã—ã¦Disable threading for Pull Request and Issue notifications.ã‚’`enabled`ã«ã—ã¾ã™ã€‚


æ¬¡ã«ãƒ¬ãƒã‚¸ãƒˆãƒªã‚’ã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–ã—ã¾ã™ã€‚

```bash
# å®Ÿè¡Œã™ã‚‹ã®ã¯ã“ã‚Œï¼ˆorg/repoã¯èª­ã¿æ›¿ãˆã¦ãã ã•ã„ï¼‰
/github subscribe org/repo comments +label:â€˜releasedâ€™

# çµæœ
âœ… Subscribed to org/repo. This channel will receive notifications for
issues, pulls, commits, releases, deployments, comments, +label:'released'

# ä½™è¨ˆãªã‚‚ã®ãŒè‰²ã€…ã¤ã„ã¦ããŸã®ã§ã€unsubscribeã—ã¾ã™ã€‚
/github unsubscribe org/repo issues pulls commits releases deployments

# ã“ã†ãªã£ãŸã‚‰OKã§ã™
This channel will receive notifications from org/repo for: comments, +label:'released'
```

### æ‰‹é †2/2ã€CIã«ã¦ãƒ—ãƒ«ãƒªã‚¯ã«ãƒ©ãƒ™ãƒªãƒ³ã‚°ã€ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹ghã‚³ãƒãƒ³ãƒ‰ã‚’è¿½åŠ 

è‚å¿ƒãªè¡Œã¯ãŸã£ãŸã“ã‚Œã ã‘ã§ã™ã€‚æœ¬ç•ªåæ˜ ã•ã‚ŒãŸå¾Œã®stepã§å®Ÿè¡Œã—ã¾ã™ã€‚

```bash
gh pr edit ${{ github.event.pull_request.number }} --add-label "released"
gh pr comment ${{ github.event.pull_request.number }} --body "ä¸Šè¨˜ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸï¼"
```

Event typeãŒãƒ—ãƒ«ãƒªã‚¯ã§ã‚ã‚‹ã“ã¨ã€ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã€PATãªã©ã‚‚å«ã‚å°‘ã—è£œè¶³ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
ï¼ˆpermissionã¯ä¸è¦ãªã‚‚ã®ã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ğŸ™ï¼‰

```yml
name: Release applications

on:
  pull_request:
    branches:
      - main
    types: [closed]

permissions:
  id-token: write
  contents: read
  issues: write
  pull-requests: write

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - name: Release
        uses: ./.github/actions/release # ã“ã“ã§ãƒªãƒªãƒ¼ã‚¹ã€åæ˜ ã¾ã§å¾…æ©Ÿ
      - name: Notify release note
        run: |
          gh pr edit ${{ github.event.pull_request.number }} --add-label "released"
          gh pr comment ${{ github.event.pull_request.number }} --body "ä¸Šè¨˜ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸï¼"
        env:
          GH_TOKEN: ${{secrets.G8_GH_TOKEN}}
```

ã¾ãŸã€CircleCIã‚’ä½¿ã£ã¦ã„ã‚‹ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã®å ´åˆã¯ãƒ—ãƒ«ãƒªã‚¯ã®ç•ªå·ãŒã¨ã‚Œãªã„ã€ghãŒç„¡ã„ã®ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å°‘ã—ã‚´ãƒªæŠ¼ã—ãŒå¿…è¦ã§ã—ãŸã€‚PR_NUMBERãŒæ­£ã—ã„ã‹æ‹…ä¿ã•ã‚Œã¦ã„ã¾ã›ã‚“ãŒã€é«˜é »åº¦ã§ãƒãƒ¼ã‚¸ã•ã‚Œã‚‹ã“ã¨ãŒãªã„ã®ã§ã€ãƒ¨ã‚·ã¨ã—ã¦ã„ã¾ã™ã€‚


```yml
# org/repoã¯èª­ã¿æ›¿ãˆã¦ãã ã•ã„
orbs:
  gh: circleci/github-cli@2.2.0

jobs:
  release:
    steps:
      - release # ã“ã“ã§ãƒªãƒªãƒ¼ã‚¹ã€åæ˜ ã¾ã§å¾…æ©Ÿ
      - gh/setup
      - run:
          name: Notify release note
          command: |
            PR_NUMBER=$(gh pr list --repo org/repo --state merged --base main --limit 1 --json number --json number | jq -r '.[0].number')
            gh pr edit $PR_NUMBER --repo org/repo --add-label "released"
            gh pr comment $PR_NUMBER --repo org/repo --body "ä¸Šè¨˜ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸï¼"
```

ã†ã¾ãå‹•ã‘ã°ã€æœ¬ç•ªåæ˜ å¾Œã€æŒ‡å®šã®ãƒãƒ£ãƒ³ãƒãƒ«ã«ãƒ—ãƒ«ãƒªã‚¯ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒåˆ°ç€ã™ã‚‹ã¯ãšã§ã™ã€‚

## ãŠã¾ã‘ã€‚ãƒ—ãƒ«ãƒªã‚¯ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚‚CIã§çµ±åˆ¶ã™ã‚‹

ãƒ—ãƒ«ãƒªã‚¯ã®ã‚¿ã‚¤ãƒˆãƒ«ãŒãã®ã¾ã¾äº‹æ¥­ã®ãƒ¡ãƒ³ãƒãƒ¼å…¨ä½“ã«å…±æœ‰ã•ã‚Œã‚‹ã®ã§ã€ãƒ—ãƒ«ãƒªã‚¯ã®ã‚¿ã‚¤ãƒˆãƒ«ã¯è‰¯ã„æ„å‘³ã§æ°—ã‚’é£ã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã—ã‹ã—ã€ãƒ“ã‚¸ãƒã‚¹ã‚µã‚¤ãƒ‰ã«åˆ†ã‹ã‚‹ã‚ˆã†ã«éæ©Ÿèƒ½è¦ä»¶ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚„ã€ã¾ã è¡¨é¢çš„ãªå¤‰åŒ–ã‚’ã‚‚ãŸã‚‰ã•ãªã„å®Ÿè£…ã¾ã§ã‚¿ã‚¤ãƒˆãƒªãƒ³ã‚°ã‚’å¿ƒãŒã‘ã‚‹ã®ã¯å¤§å¤‰ã§ã™ã€‚ã‚ˆã£ã¦ã€ãƒ—ãƒ«ãƒªã‚¯ã®ã‚¿ã‚¤ãƒˆãƒ«ã«ã¯ä»¥ä¸‹ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’è¨­ã‘ã‚‹ãƒ«ãƒ¼ãƒ«ã¨ã—ã€ã€Œæ–°æ©Ÿèƒ½ãƒªãƒªãƒ¼ã‚¹ã€ã¨ã€Œãƒã‚°ä¿®æ­£ãƒªãƒªãƒ¼ã‚¹ã€ä»¥å¤–ã¯ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã•ãˆåˆ†ã‹ã‚Œã°è‰¯ã„ã€ã¨ã„ã†ã‚ˆã†ã«ãƒ«ãƒ¼ãƒ«ã‚’è»ŸåŒ–ã—ã¦ã„ã¾ã™ã€‚ãã—ã¦ãƒ“ã‚¸ãƒã‚¹ã‚µã‚¤ãƒ‰ã‚‚åŸºæœ¬çš„ã«ã€Œæ–°æ©Ÿèƒ½ãƒªãƒªãƒ¼ã‚¹ã€ã¨ã€Œãƒã‚°ä¿®æ­£ãƒªãƒªãƒ¼ã‚¹ã€ãŒå…ˆé ­ã«ã‚ã‚‹ã‚¿ã‚¤ãƒˆãƒ«ã ã‘æ³¨ç›®ã™ã‚Œã°è‰¯ãã€åŒæ–¹ã«è² è·ãŒä½ã„çŠ¶æ…‹ã«ãªã‚Šã¾ã™ã€‚

- `æ–°æ©Ÿèƒ½ãƒªãƒªãƒ¼ã‚¹` â†’ äº‹æ¥­éƒ¨ãŒèªçŸ¥ã§ãã‚‹ã€Œæ„å›³ã™ã‚‹ã€æŒ™å‹•ã‚’ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹ã¨ã
- `æ–°æ©Ÿèƒ½æº–å‚™` â†’ æ–°æ©Ÿèƒ½ãƒªãƒªãƒ¼ã‚¹ã«ç¹‹ãŒã‚‹ãŒã€ã¾ã æŒ™å‹•å¤‰æ›´ãŒãªã„ã¨ã
- `ãƒã‚°ä¿®æ­£ãƒªãƒªãƒ¼ã‚¹` â†’ äº‹æ¥­éƒ¨ãŒèªçŸ¥ã§ãã‚‹å…ƒã€…ã€Œæ„å›³ã—ãªã‹ã£ãŸã€æŒ™å‹•ãŒç›´ã‚‹ã¨ã
- `ãƒã‚°ä¿®æ­£æº–å‚™` â†’ ãƒã‚°ä¿®æ­£ãƒªãƒªãƒ¼ã‚¹ã«ç¹‹ãŒã‚‹ãŒã€ã¾ã æŒ™å‹•å¤‰æ›´ãŒãªã„ã¨ã
- `éæ©Ÿèƒ½è¦ä»¶` â†’ æŒ™å‹•ãŒå¤‰ã‚ã‚‰ãšäº‹æ¥­éƒ¨ãŒèªçŸ¥ã§ããªã„ãªã„ã‚‚ã®ã™ã¹ã¦

ãã—ã¦ã€æ¯å›ã“ã®prefixã‚’å…¥åŠ›ã—ã¦ã‚‚ã‚‰ã†ã®ã‚‚ç”³ã—è¨³ãªã„ã®ã§ã€ã“ã®å‡¦ç†ã‚’å°‘ã—è‡ªå‹•åŒ–ã—ã¾ã—ãŸã€‚ã“ã‚Œã‚‰ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’labelã§ç”¨æ„ã—ã¦ãŠã‚Šã€ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«è‡¨ã¿ã¾ã™ã€‚ãã—ã¦ãƒãƒ¼ã‚¸æ™‚ã«ã¯CIã«ã¦ãƒ©ãƒ™ãƒ«ã«å¿œã˜ã¦ã€ãƒ—ãƒ«ãƒªã‚¯ã®ã‚¿ã‚¤ãƒˆãƒ«ã®å…ˆé ­ã«ãƒ©ãƒ™ãƒ«ã‚’ä»˜ä¸ã—ã¦ã„ã¾ã™ã€‚

ãƒ©ãƒ™ãƒ«ä»˜ä¸ã‚’å¼·åˆ¶ã™ã‚‹CIã¯ã“ã¡ã‚‰ã§ã™ã€‚

```yml
name: Check

on:
  pull_request:
    branches-ignore:
      - main

permissions:
  id-token: write
  contents: write
  pull-requests: read

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Check if PR has required labels
        id: check
        uses: actions/github-script@v5.1.0
        with:
          script: |
            const pr = await github.rest.pulls.get({ // rerunã—ãŸéš›ã«æœ€æ–°ã®ãƒ©ãƒ™ãƒ«æƒ…å ±ãŒæ›´æ–°ã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹
              owner: context.repo.owner,
              repo: context.repo.repo,
              pull_number: context.issue.number
            });
            const currentLabels = pr.data.labels.map((label) => label.name);
            const requiredLabels = ["æ–°æ©Ÿèƒ½ãƒªãƒªãƒ¼ã‚¹", "æ–°æ©Ÿèƒ½æº–å‚™", "ãƒã‚°ä¿®æ­£æº–å‚™", "ãƒã‚°ä¿®æ­£ãƒªãƒªãƒ¼ã‚¹", "éæ©Ÿèƒ½è¦ä»¶"];
            const countOfRequiredLabels = requiredLabels.filter((label) => currentLabels.includes(label)).length;
            if(countOfRequiredLabels !== 1) {
              core.setFailed(`PRã«ã¯æ¬¡ã®ã†ã¡1ã¤ã®ãƒ©ãƒ™ãƒ«ãŒå¿…è¦ã§ã™ã€‚ä»˜ä¸ã—ã¦ã‹ã‚‰ã€ã“ã®jobã‚’rerunã—ã¦ãã ã•ã„ã€‚${requiredLabels.map((label) => `"${label}"`).join(", ")}`);
            }
```

ãƒãƒ¼ã‚¸æ™‚ã«ãƒ—ãƒ«ãƒªã‚¯ã‚¿ã‚¤ãƒˆãƒ«ã‚’æ›´æ–°ã™ã‚‹CIã¯ã“ã¡ã‚‰

```yml
name: modify-title
on:
  pull_request:
    branches:
      - development
    types: [closed]

jobs:
  modify-title:
    runs-on: ubuntu-latest
    if: github.event.pull_request.merged == true
    steps:
      - name: Update PR title
        uses: actions/github-script@v5
        with:
          script: |
            const pr = context.payload.pull_request;
            const requiredLabels = ["æ–°æ©Ÿèƒ½ãƒªãƒªãƒ¼ã‚¹", "æ–°æ©Ÿèƒ½æº–å‚™", "ãƒã‚°ä¿®æ­£æº–å‚™", "ãƒã‚°ä¿®æ­£ãƒªãƒªãƒ¼ã‚¹", "éæ©Ÿèƒ½è¦ä»¶"];
            const label = pr.labels.find(label => requiredLabels.includes(label.name)).name;
            if (!pr.title.startsWith(`ã€${label}ã€‘`)) {
              const newTitle = `ã€${label}ã€‘ ${pr.title}`;
              await github.rest.pulls.update({
                owner: context.repo.owner,
                repo: context.repo.repo,
                pull_number: context.issue.number,
                title: newTitle
              });
            }
```

å‰¯æ¬¡çš„ã«å„äººã‚„ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆãŒå®Ÿè¡Œã§ããŸæ–½ç­–æ•°ã‚’è¦‹ãˆã‚‹åŒ–ã‚‚ã§ããŸã®ã§ã€æŒ¯ã‚Šè¿”ã‚Šã«æ´»ç”¨ã—ã¦ã„ã“ã†ã¨æ€ã„ã¾ã™ã€‚
ä»¥ä¸Šã§ã™ã€‚
